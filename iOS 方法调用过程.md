

#### 一 方法调用流程



调用方法分为调用实例方法和调用类方法，在结构体我们可以看到第一个就是一个 isa 指针，会指向类对象或者元类。



每个实例对象有个isa的指针，他指向对象的类，而类里也有个isa的指针, 指向meteClass(元类)。元类保存了类方法的列表。当类方法被调用时，先会从元类本身查找类方法的实现，如果没有，元类会向他父类查找该方法。同时注意的是：元类（meteClass）也是类，它也是对象。元类也有isa指针,它的isa指针最终指向的是一个根元类(root meteClass)。根元类的isa指针指向本身，这样形成了一个封闭的内循环。
通过isa，就可以不断往上方去回溯自己的父类等，而方法的调用也利用了这个过程：





iOS 工程中，调用对象的方法，就是向对象发送消息。我们知道，iOS 中的方法分为实例方法和对象方法。iOS 所有的对象都是继承至 NSObject, 编译完成后，在对象的定义中，存在一个实例方法链表、一个缓存方法链表。当对实例 son 发送消息后，会在 son 缓存方法链表中寻找；缓存中没有时，向实例方法链表寻找；再找不到，会向父类的实例方法缓存链表 -> 父类的实例方法链表寻找，直至 NSObject。在 NSObject 中会经历以下两个步骤：



##### 1 方法调用的过程--调用实例方法



1.在对象的<缓存方法列表> 中去找要调用的方法，找到直接执行其实现。
2.对象的<缓存方法列表> 里没找到，就去<类的方法列表>里找，找到了就执行其实现。
3.还没找到，说明这个类自己没有了，就会通过isa去向其父类里执行1、2。
4.如果找到了根类还没找到，那么就是没有了，会转向一个拦截调用的方法，可以自己在拦截调用方法里面做一些处理。
5.如果没有在拦截调用里做处理，那么就会报错崩溃。





##### 2 方法调用的过程--调用类方法

1.在类的<缓存方法列表> 中去找要调用的方法，找到直接执行其实现。
2.类的<缓存方法列表> 里没找到，就去<meta类的方法列表>里找，找到了就执行其实现。
3.还没找到，说明这个类自己没有了，就会通过isa去meta类的父类里执行1、2。
4.如果找到了根meta类还没找到，那么就是没有了，会转向一个拦截调用的方法，可以自己在拦截调用方法里面做一些处理。
5.如果没有在拦截调用里做处理，那么就会报错崩溃。